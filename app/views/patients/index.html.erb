<div class="box" dir="rtl">
  <div class="box-header with-border">
    <h3 class="box-title">عرض كل بيانات المرضى</h3>
  </div>
  <div class="box-body">

    <%= link_to 'إضافة حالة جديدة', new_patient_path, class: 'btn btn-primary' %>
    <br>
    <br>
    <div class="col-xs-12 table-responsive">
      <table class="table table-striped table-bordered">
        <thead>
          <tr>
            <th class="text-center">الكود</th>
            <th class="text-center">الاسم</th>
            <th class="text-center">العمر</th>
            <th class="text-center">المنطقة</th>
          </tr>
        </thead>
        <tbody>
          <% @patients.each do |patient| %>
            <tr>
              <td>
                <div class="btn-group">
                  <% if can? :update, Patient %>
                    <%= link_to edit_patient_path(patient), title: 'تعديل', class: "btn btn-warning btn-xs" do %>
                      <i class="fa fa-pencil"></i>
                    <% end %>
                  <% end %>

                  <% if can? :destroy, Patient %>
                    <%= link_to patient, method: :delete, data: { confirm: 'هل انت متاكد؟' }, title: 'حذف', class: "btn btn-danger btn-xs" do %>
                      <i class="fa fa-trash-o"></i>
                    <% end %>
                  <% end %>
                </div>
                <%= patient.code %>
              </td>
              <td>
                <%= link_to patient.name, patient %>
                <% if can? :destroy, Patient %>
                  <span class="badge"><%= patient.visits.size %> زيارة</span>
                <% end %>
              </td>
              <td><%= time_ago_in_words patient.birthdate unless patient.birthdate.nil? %></td>
              <td><%= patient.region&.name %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

  </div>
  <div class="box-footer">
    <%= link_to 'إضافة حالة جديدة', new_patient_path, class: 'btn btn-primary' %>
  </div>
</div>
